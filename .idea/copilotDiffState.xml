<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/swieczkomat/data/CandleDao.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/swieczkomat/data/CandleDao.kt" />
              <option name="originalContent" value="package com.example.swieczkomat.data&#10;&#10;import androidx.room.*&#10;import kotlinx.coroutines.flow.Flow&#10;&#10;@Dao&#10;interface CandleDao {&#10;    @Insert&#10;    suspend fun insert(candle: Candle)&#10;&#10;    @Update&#10;    suspend fun update(candle: Candle)&#10;&#10;    @Query(&quot;SELECT * FROM candles ORDER BY dateMade DESC&quot;)&#10;    fun getAllCandles(): Flow&lt;List&lt;Candle&gt;&gt;&#10;&#10;    @Query(&quot;UPDATE candles SET burnTimeMinutes = :minutes WHERE id = :id&quot;)&#10;    suspend fun updateBurnTime(id: Int, minutes: Int)&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.swieczkomat.data&#10;&#10;import androidx.room.*&#10;import kotlinx.coroutines.flow.Flow&#10;&#10;@Dao&#10;interface CandleDao {&#10;    @Insert&#10;    suspend fun insert(candle: Candle)&#10;&#10;    @Update&#10;    suspend fun update(candle: Candle)&#10;&#10;    @Query(&quot;SELECT * FROM candles ORDER BY dateMade DESC&quot;)&#10;    fun getAllCandles(): Flow&lt;List&lt;Candle&gt;&gt;&#10;&#10;    @Query(&quot;SELECT * FROM candles WHERE id = :id&quot;)&#10;    suspend fun getById(id: Int): Candle?&#10;&#10;    @Query(&quot;DELETE FROM candles WHERE id = :id&quot;)&#10;    suspend fun deleteById(id: Int)&#10;&#10;    @Query(&quot;UPDATE candles SET burnTimeMinutes = :minutes WHERE id = :id&quot;)&#10;    suspend fun updateBurnTime(id: Int, minutes: Int)&#10;&#10;    @Query(&quot;UPDATE candles SET burnTimeMinutes = burnTimeMinutes + :delta WHERE id = :id&quot;)&#10;    suspend fun incrementBurnTime(id: Int, delta: Int)&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/swieczkomat/ui/screens/CandlesScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/swieczkomat/ui/screens/CandlesScreen.kt" />
              <option name="originalContent" value="package com.example.swieczkomat.ui.screens&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.swieczkomat.data.Candle&#10;import com.example.swieczkomat.vievmodels.CandleViewModel&#10;import com.example.swieczkomat.vievmodels.MaterialsViewModel&#10;import com.example.swieczkomat.ui.dialogs.AddCandleDialog&#10;import java.text.SimpleDateFormat&#10;import java.util.*&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Add&#10;&#10;@Composable&#10;fun CandlesTab(darkMode: Boolean, candleViewModel: CandleViewModel, materialsViewModel: MaterialsViewModel) {&#10;    val candles by candleViewModel.getAllCandles().collectAsState(initial = emptyList())&#10;    val materials by materialsViewModel.getAllMaterials().collectAsState(initial = emptyList())&#10;    var showAddDialog by remember { mutableStateOf(false) }&#10;    val dateFormat = remember { SimpleDateFormat(&quot;yyyy-MM-dd&quot;, Locale.getDefault()) }&#10;    Box(modifier = Modifier.fillMaxSize()) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(12.dp)&#10;        ) {&#10;            Text(&quot;Świeczki&quot;, fontSize = 20.sp, fontWeight = FontWeight.Bold, color = if (darkMode) Color.White else Color.Black)&#10;            Spacer(Modifier.height(12.dp))&#10;            LazyColumn { items(candles) { candle -&gt; CandleRow(candle, darkMode, dateFormat) } }&#10;        }&#10;        FloatingActionButton(&#10;            onClick = { showAddDialog = true },&#10;            containerColor = Color(0xFF2563EB),&#10;            modifier = Modifier.align(Alignment.BottomEnd).padding(16.dp)&#10;        ) { Icon(Icons.Default.Add, contentDescription = &quot;Dodaj świeczki&quot;, tint = Color.White) }&#10;    }&#10;    if (showAddDialog) {&#10;        AddCandleDialog(&#10;            darkMode = darkMode,&#10;            materials = materials,&#10;            candleViewModel = candleViewModel,&#10;            onDismiss = { showAddDialog = false }&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun CandleRow(candle: Candle, darkMode: Boolean, dateFormat: SimpleDateFormat) {&#10;    Card(modifier = Modifier.fillMaxWidth().padding(vertical = 4.dp), elevation = CardDefaults.cardElevation(2.dp)) {&#10;        Column(modifier = Modifier.padding(12.dp)) {&#10;            Text(&quot;Dla: ${candle.forWhom}&quot;, fontWeight = FontWeight.SemiBold, color = if (darkMode) Color.White else Color.Black)&#10;            Text(&quot;Pojemnik: ${candle.containerName ?: &quot;-&quot;}&quot;)&#10;            Text(&quot;Zapach: ${candle.fragranceName ?: &quot;-&quot;} (${candle.concentration}%)&quot;)&#10;            Text(&quot;Knot: ${candle.wickName ?: &quot;-&quot;}&quot;)&#10;            candle.dyeName?.let { Text(&quot;Barwnik: $it&quot;) }&#10;            Text(&quot;Koszt: ${String.format(Locale.getDefault(),&quot;%.2f zł&quot;, candle.cost)}&quot;)&#10;            Text(&quot;Zrobiona: ${dateFormat.format(Date(candle.dateMade))}&quot;)&#10;            Text(&quot;Odpalić po: ${dateFormat.format(Date(candle.dateToLight))}&quot;)&#10;            Text(&quot;Czas palenia: ${candle.burnTimeMinutes} min&quot;)&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.swieczkomat.ui.screens&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.swieczkomat.data.Candle&#10;import com.example.swieczkomat.vievmodels.CandleViewModel&#10;import com.example.swieczkomat.vievmodels.MaterialsViewModel&#10;import com.example.swieczkomat.ui.dialogs.AddCandleDialog&#10;import java.text.SimpleDateFormat&#10;import java.util.*&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Add&#10;import androidx.compose.material.icons.filled.Delete&#10;import androidx.compose.material.icons.filled.Edit&#10;import androidx.compose.material.icons.filled.Timer&#10;import kotlinx.coroutines.launch&#10;&#10;@Composable&#10;fun CandlesTab(darkMode: Boolean, candleViewModel: CandleViewModel, materialsViewModel: MaterialsViewModel) {&#10;    val candles by candleViewModel.getAllCandles().collectAsState(initial = emptyList())&#10;    val materials by materialsViewModel.getAllMaterials().collectAsState(initial = emptyList())&#10;    var showAddDialog by remember { mutableStateOf(false) }&#10;    var editTargetId by remember { mutableStateOf&lt;Int?&gt;(null) }&#10;    val dateFormat = remember { SimpleDateFormat(&quot;yyyy-MM-dd&quot;, Locale.getDefault()) }&#10;    val scope = rememberCoroutineScope()&#10;    Box(modifier = Modifier.fillMaxSize()) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(12.dp)&#10;        ) {&#10;            Text(&quot;Świeczki&quot;, fontSize = 20.sp, fontWeight = FontWeight.Bold, color = if (darkMode) Color.White else Color.Black)&#10;            Spacer(Modifier.height(12.dp))&#10;            LazyColumn { items(candles) { candle -&gt; CandleRow(candle, darkMode, dateFormat,&#10;                onEdit = { editTargetId = candle.id },&#10;                onDelete = { candleViewModel.deleteCandle(candle.id) },&#10;                onAddBurn = { candleViewModel.addBurnTime(candle.id, 15) }&#10;            ) } }&#10;        }&#10;        FloatingActionButton(&#10;            onClick = { showAddDialog = true },&#10;            containerColor = Color(0xFF2563EB),&#10;            modifier = Modifier.align(Alignment.BottomEnd).padding(16.dp)&#10;        ) { Icon(Icons.Default.Add, contentDescription = &quot;Dodaj świeczki&quot;, tint = Color.White) }&#10;    }&#10;    if (showAddDialog) {&#10;        AddCandleDialog(&#10;            darkMode = darkMode,&#10;            materials = materials,&#10;            candleViewModel = candleViewModel,&#10;            onDismiss = { showAddDialog = false }&#10;        )&#10;    }&#10;    editTargetId?.let { id -&gt;&#10;        val candleToEdit = candles.find { it.id == id }&#10;        if (candleToEdit != null) {&#10;            EditCandleDialog(&#10;                darkMode = darkMode,&#10;                candle = candleToEdit,&#10;                onDismiss = { editTargetId = null },&#10;                onSave = { updated -&gt; candleViewModel.updateCandle(updated); editTargetId = null }&#10;            )&#10;        } else { editTargetId = null }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun CandleRow(&#10;    candle: Candle,&#10;    darkMode: Boolean,&#10;    dateFormat: SimpleDateFormat,&#10;    onEdit: () -&gt; Unit,&#10;    onDelete: () -&gt; Unit,&#10;    onAddBurn: () -&gt; Unit&#10;) {&#10;    Card(modifier = Modifier.fillMaxWidth().padding(vertical = 4.dp), elevation = CardDefaults.cardElevation(2.dp)) {&#10;        Column(modifier = Modifier.padding(12.dp)) {&#10;            Text(&quot;Dla: ${candle.forWhom}&quot;, fontWeight = FontWeight.SemiBold, color = if (darkMode) Color.White else Color.Black)&#10;            Text(&quot;Pojemnik: ${candle.containerName ?: &quot;-&quot;}&quot;)&#10;            Text(&quot;Zapach: ${candle.fragranceName ?: &quot;-&quot;} (${candle.concentration}%)&quot;)&#10;            Text(&quot;Knot: ${candle.wickName ?: &quot;-&quot;}&quot;)&#10;            candle.dyeName?.let { Text(&quot;Barwnik: $it&quot;) }&#10;            Text(&quot;Koszt: ${String.format(Locale.getDefault(),&quot;%.2f zł&quot;, candle.cost)}&quot;)&#10;            Text(&quot;Zrobiona: ${dateFormat.format(Date(candle.dateMade))}&quot;)&#10;            Text(&quot;Odpalić po: ${dateFormat.format(Date(candle.dateToLight))}&quot;)&#10;            Text(&quot;Czas palenia: ${candle.burnTimeMinutes} min&quot;)&#10;            Spacer(Modifier.height(8.dp))&#10;            Row(horizontalArrangement = Arrangement.spacedBy(8.dp)) {&#10;                OutlinedButton(onClick = onAddBurn) { Icon(Icons.Default.Timer, contentDescription = null); Spacer(Modifier.width(4.dp)); Text(&quot;+15 min&quot;) }&#10;                OutlinedButton(onClick = onEdit) { Icon(Icons.Default.Edit, contentDescription = null); Spacer(Modifier.width(4.dp)); Text(&quot;Edytuj&quot;) }&#10;                OutlinedButton(onClick = onDelete, colors = ButtonDefaults.outlinedButtonColors(contentColor = Color.Red)) { Icon(Icons.Default.Delete, contentDescription = null); Spacer(Modifier.width(4.dp)); Text(&quot;Usuń&quot;) }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;private fun EditCandleDialog(&#10;    darkMode: Boolean,&#10;    candle: Candle,&#10;    onDismiss: () -&gt; Unit,&#10;    onSave: (Candle) -&gt; Unit&#10;) {&#10;    var forWhom by remember { mutableStateOf(candle.forWhom) }&#10;    var burnTime by remember { mutableStateOf(candle.burnTimeMinutes.toString()) }&#10;    val fieldContainerColor = if (darkMode) Color(0xFF2F2F35) else Color(0xFFF3F4F6)&#10;    val fieldTextColor = if (darkMode) Color.White else Color.Black&#10;    val fieldLabelColor = if (darkMode) Color(0xFFCBD5E1) else Color(0xFF374151)&#10;    Dialog(onDismissRequest = onDismiss) {&#10;        Card(shape = RoundedCornerShape(16.dp), colors = CardDefaults.cardColors(containerColor = if (darkMode) Color(0xFF3B3B44) else Color.White)) {&#10;            Column(Modifier.padding(16.dp).fillMaxWidth()) {&#10;                Text(&quot;Edytuj świeczkę&quot;, fontSize = 20.sp, color = if (darkMode) Color.White else Color.Black)&#10;                Spacer(Modifier.height(12.dp))&#10;                OutlinedTextField(&#10;                    value = forWhom,&#10;                    onValueChange = { forWhom = it },&#10;                    label = { Text(&quot;Dla kogo?&quot;, color = fieldLabelColor) },&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    colors = OutlinedTextFieldDefaults.colors(&#10;                        focusedContainerColor = fieldContainerColor,&#10;                        unfocusedContainerColor = fieldContainerColor,&#10;                        disabledContainerColor = fieldContainerColor,&#10;                        focusedTextColor = fieldTextColor,&#10;                        unfocusedTextColor = fieldTextColor,&#10;                        focusedLabelColor = fieldLabelColor,&#10;                        unfocusedLabelColor = fieldLabelColor,&#10;                        cursorColor = fieldTextColor&#10;                    )&#10;                )&#10;                Spacer(Modifier.height(12.dp))&#10;                OutlinedTextField(&#10;                    value = burnTime,&#10;                    onValueChange = { burnTime = it.filter { ch -&gt; ch.isDigit() } },&#10;                    label = { Text(&quot;Czas palenia (min)&quot;, color = fieldLabelColor) },&#10;                    keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Number),&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    colors = OutlinedTextFieldDefaults.colors(&#10;                        focusedContainerColor = fieldContainerColor,&#10;                        unfocusedContainerColor = fieldContainerColor,&#10;                        disabledContainerColor = fieldContainerColor,&#10;                        focusedTextColor = fieldTextColor,&#10;                        unfocusedTextColor = fieldTextColor,&#10;                        focusedLabelColor = fieldLabelColor,&#10;                        unfocusedLabelColor = fieldLabelColor,&#10;                        cursorColor = fieldTextColor&#10;                    )&#10;                )&#10;                Spacer(Modifier.height(16.dp))&#10;                Row(modifier = Modifier.align(Alignment.End)) {&#10;                    TextButton(onClick = onDismiss) { Text(&quot;Anuluj&quot;) }&#10;                    Spacer(Modifier.width(8.dp))&#10;                    Button(onClick = {&#10;                        val updated = candle.copy(forWhom = forWhom.ifBlank { &quot;&quot; }, burnTimeMinutes = burnTime.toIntOrNull() ?: candle.burnTimeMinutes)&#10;                        onSave(updated)&#10;                    }, colors = ButtonDefaults.buttonColors(containerColor = Color(0xFF7C3AED))) { Text(&quot;Zapisz&quot;) }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/swieczkomat/vievmodels/CandleViewModel.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/swieczkomat/vievmodels/CandleViewModel.kt" />
              <option name="originalContent" value="package com.example.swieczkomat.vievmodels&#10;&#10;import android.app.Application&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.ViewModelProvider&#10;import androidx.lifecycle.viewModelScope&#10;import com.example.swieczkomat.data.AppDatabase&#10;import com.example.swieczkomat.data.Candle&#10;import com.example.swieczkomat.data.CandleDao&#10;import kotlinx.coroutines.flow.Flow&#10;import kotlinx.coroutines.launch&#10;&#10;class CandleViewModel(private val candleDao: CandleDao) : ViewModel() {&#10;    fun getAllCandles(): Flow&lt;List&lt;Candle&gt;&gt; = candleDao.getAllCandles()&#10;&#10;    fun addCandles(candles: List&lt;Candle&gt;) {&#10;        viewModelScope.launch {&#10;            candles.forEach { candleDao.insert(it) }&#10;        }&#10;    }&#10;&#10;    fun addBurnTime(id: Int, minutesToAdd: Int) {&#10;        viewModelScope.launch {&#10;            val currentList = candleDao.getAllCandles()&#10;            // Simplified: fetch latest snapshot via collection not ideal; better separate query but kept minimal.&#10;            // In real scenario create dedicated query to get single candle.&#10;        }&#10;    }&#10;&#10;    fun setBurnTime(id: Int, minutes: Int) {&#10;        viewModelScope.launch { candleDao.updateBurnTime(id, minutes) }&#10;    }&#10;}&#10;&#10;class CandleViewModelFactory(private val application: Application) : ViewModelProvider.Factory {&#10;    override fun &lt;T : ViewModel&gt; create(modelClass: Class&lt;T&gt;): T {&#10;        if (modelClass.isAssignableFrom(CandleViewModel::class.java)) {&#10;            @Suppress(&quot;UNCHECKED_CAST&quot;)&#10;            return CandleViewModel(AppDatabase.getDatabase(application).candleDao()) as T&#10;        }&#10;        throw IllegalArgumentException(&quot;Unknown ViewModel class&quot;)&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.swieczkomat.vievmodels&#10;&#10;import android.app.Application&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.ViewModelProvider&#10;import androidx.lifecycle.viewModelScope&#10;import com.example.swieczkomat.data.AppDatabase&#10;import com.example.swieczkomat.data.Candle&#10;import com.example.swieczkomat.data.CandleDao&#10;import kotlinx.coroutines.flow.Flow&#10;import kotlinx.coroutines.launch&#10;&#10;class CandleViewModel(private val candleDao: CandleDao) : ViewModel() {&#10;    fun getAllCandles(): Flow&lt;List&lt;Candle&gt;&gt; = candleDao.getAllCandles()&#10;&#10;    fun addCandles(candles: List&lt;Candle&gt;) {&#10;        viewModelScope.launch {&#10;            candles.forEach { candleDao.insert(it) }&#10;        }&#10;    }&#10;&#10;    fun updateCandle(candle: Candle) {&#10;        viewModelScope.launch { candleDao.update(candle) }&#10;    }&#10;&#10;    fun deleteCandle(id: Int) {&#10;        viewModelScope.launch { candleDao.deleteById(id) }&#10;    }&#10;&#10;    fun addBurnTime(id: Int, minutesToAdd: Int) {&#10;        viewModelScope.launch { candleDao.incrementBurnTime(id, minutesToAdd) }&#10;    }&#10;&#10;    fun setBurnTime(id: Int, minutes: Int) {&#10;        viewModelScope.launch { candleDao.updateBurnTime(id, minutes) }&#10;    }&#10;&#10;    suspend fun getById(id: Int): Candle? = candleDao.getById(id)&#10;}&#10;&#10;class CandleViewModelFactory(private val application: Application) : ViewModelProvider.Factory {&#10;    override fun &lt;T : ViewModel&gt; create(modelClass: Class&lt;T&gt;): T {&#10;        if (modelClass.isAssignableFrom(CandleViewModel::class.java)) {&#10;            @Suppress(&quot;UNCHECKED_CAST&quot;)&#10;            return CandleViewModel(AppDatabase.getDatabase(application).candleDao()) as T&#10;        }&#10;        throw IllegalArgumentException(&quot;Unknown ViewModel class&quot;)&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>